import sys
import base64
from pwn import *

if len(sys.argv) < 3:
    print(f"Use: {sys.argv[0]} HOST PORT")

p = 115792089210356248762697446949407573530086143415290314195533631308867097853951
payload = base64.b64encode(p.to_bytes(32, "big") + b"\x00" * 32)

r = remote(sys.argv[1], sys.argv[2])

r.recvuntil(b"Base64:")
r.sendline(payload)
r.recvline()
r.recvline()
flag = r.recvuntil(b"}")

if b"CSR" in flag:
    print("Flag:", flag.decode())
else:
    print("Flag not returned.")
    sys.exit(1)